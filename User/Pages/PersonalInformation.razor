@page "/personalinformation"
@using ClassLibraryEntities
@using ClassLibraryDAL
@inject NavigationManager nm;
@inject AuthenticationStateProvider authStateProvider
@attribute [Authorize(Roles = "User")]


<style>
    .form-outline {
        margin-top: 1rem;
    }
</style>
<div>
    <EditForm Model="_ModelInfo" OnSubmit="SubmitForm">




        <div class="container">
            <div class="d-flex justify-content-center " style="margin-top:2rem">
                <div class="shadow-sm pb-5" style="background-color:white; border-radius:1rem; padding:2rem;">
                    <h4 class="text-primary text-center mt-5">Personal Information</h4>

                    <div class="form-outline">
                        @* <label for="exampleFormControlInput1" class="form-label text-black">Name</label>*@
                        <InputText @bind-Value="_ModelInfo.FirstName" class="form-control form-control-lg" placeholder="Enter Name" />

                    </div>


                    <div class="form-outline">

                        @*  <label for="exampleFormControlInput1" class="form-label text-black">Father Name</label>*@
                        <InputText @bind-Value="_ModelInfo.FatherName" class="form-control form-control-lg" placeholder="Enter Father Name" />
                    </div>



                    <div class="form-outline">
                        @*<label for="exampleFormControlInput1" class="form-label text-black">Gender</label>*@
                        <Select @onchange="_EditGender" class="form-select form-select-lg">
                            <option selected>Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>

                        </Select>
                    </div>
                    <div class="form-outline">
                        @*      <label for="exampleFormControlInput1" class="form-label text-black">Student CNIC</label>*@
                        <InputText @bind-Value="_ModelInfo.CNIC" class="form-control form-control-lg" placeholder="Enter Cnic" />
                    </div>



                    <div class="form-outline">

                        @*    <label for="exampleFormControlInput1" class="form-label text-black">Date of Birth</label>*@
                        <InputText type="date" @bind-Value="_ModelInfo.DateOfBirth" class="form-control form-control-lg" />
                    </div>





                    <div class="form-outline">
                        @*
                        <label for="exampleFormControlInput1" class="form-label text-black">City</label>*@
                        <Select @onchange="_EditCity" class="form-select form-select-lg">
                            <option selected>Select City</option>
                            <option value="Faisalabad">Faisalabad</option>
                            <option value="Multan">Multan</option>
                            <option value="Gujranwala">Gujranwala</option>
                            <option value="Hyderabad">Hyderabad</option>
                            <option value="Peshawar">Peshawar</option>
                            <option value="Quetta">Quetta</option>


                        </Select>

                    </div>






                    <div class="form-outline">

                        @*  <label for="exampleFormControlInput1" class="form-label text-black">Address</label>*@
                        <InputText @bind-Value="_ModelInfo.Address" class="form-control form-control-lg" placeholder="Enter Address" />

                    </div>




                    <div class="form-outline">
                        @*     <label for="exampleFormControlInput1" class="form-label text-black">Student Mobile Number</label>*@
                        <InputText type="tel" @bind-Value="_ModelInfo.StudentMobileNo" class="form-control form-control-lg" placeholder="Enter Mobile Number" />

                    </div>




                    <div class="form-outline">
                        @*<label class="form-label text-black">Email</label>*@
                        <InputText type="email" @bind-Value="_ModelInfo.Email" class="form-control form-control-lg" placeholder="Enter Email" />

                    </div>

                    <div>
                        <button type="submit" class="btn btn-primary mr-3 mt-3" style="padding-left: 12rem; padding-right: 12rem;">Register</button>

                    </div>
                    @*<div>
                    <button type="reset" class="btn btn-secondary mr-3 mt-3 " style="padding-left: 12rem; padding-right: 12rem;">Reset</button>
                    </div>*@

                </div>
            </div>

        </div>

    </EditForm>

</div>


@code {


    private EntStudentInfo? _ModelInfo { get; set; } = new EntStudentInfo();
    public string? EditCity { get; set; }
    public string? EditProvince { get; set; }
    public string? EditGender { get; set; }

    public string? value1 { get; set; }
    [CascadingParameter]
    private Task<AuthenticationState> authenticatestate { get; set; }

    private async Task DisplayGreeting()
    {
        var authState = await authenticatestate;
        value1 = $"{authState.User.Identity.Name}";

    }

    protected override void OnInitialized()
    {
        DisplayGreeting();
    }

    private void SubmitForm()
    {
        _ModelInfo.SID = value1;
        _ModelInfo.Gender = EditGender;
        _ModelInfo.City = EditCity;
        DALStudentInfo.SaveStudentInfo(_ModelInfo);
        nm.NavigateTo("/");

    }
    private void _EditCity(ChangeEventArgs e)
    {
        EditCity = e.Value as string;
    }
    private void _EditProvince(ChangeEventArgs e)
    {
        EditProvince = e.Value as string;
    }
    private void _EditGender(ChangeEventArgs e)
    {
        EditGender = e.Value as string;
    }
}