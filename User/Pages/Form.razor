@page "/form"
@using ClassLibraryDAL
@using ClassLibraryEntities


<div>
    <EditForm Model="_ModelInfo" OnSubmit="SubmitForm">
        <h2 class="text-center">Educational Information</h2>
        <div class="row mt-4 d-flex justify-content-center align-items-center">

            <div class="col-5">
                <label>Degree</label>
                <select class="form-select" aria-label="Default select example" @onchange="_DegreeOption">
                    <option selected>Select Degree</option>

                    @foreach (var reh in @PassingDegreeList)
                    {
                        <option value="@reh.PassingDegreesId">@reh.Title</option>
                    }
                </select>

            </div>

           
        </div>
        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Degree Groups</label>
                <select class="form-select" aria-label="Default select example" @onchange="_PGSGOption">
                    <option selected>Select Degree Group </option>

                    @foreach (var emp in @PassingDSGroupsList)
                    {
                        @if(degree==emp.PassingDegreeId)
                        {
                            <option value="@emp.PassingDSGroups">@emp.PassingDSGroups</option>
                        }
                        
                    }
                </select>

            </div>

        </div>
        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Board/University</label>
                <Select @onchange="_EditBU" class="form-select">
                    <option selected>Select Board</option>
                    <option value="Rwp">Rawalpindi</option>
                    <option value="Isl">Islamabad</option>

                </Select>

            </div>
        </div>


        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label> Obtained Marks </label>
                <InputText @bind-Value="_ModelInfo.ObtainedMarks" class="form-control" />

            </div>
        </div>
        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Total Marks</label>
                <input  @bind="_ModelInfo.TotalMarks"  class="form-control" />

            </div>

        </div>
        
        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Percentage</label>
                   <InputText @bind-Value="_ModelInfo.Percentage" ></InputText>         

              
            </div>
        </div>



        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Passing Year</label>
                <InputText @bind-Value="_ModelInfo.PassingYear" class="form-control" />

            </div>
        </div>

        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Institute</label>
                <InputText type="text" @bind-Value="_ModelInfo.Institute" class="form-control" />

            </div>
        </div>



        <div class="text-center">
            <button type="submit" class="btn btn-primary mr-1">Register</button>
            <button type="reset" class="btn btn-secondary">Cancel</button>
        </div>
    </EditForm>

</div>

@code {

    private EntEducationalInfo? _ModelInfo { get; set; } = new EntEducationalInfo();
    private List<EntPassingDegree>? PassingDegreeList;
    private List<EntPassingDSGroups>? PassingDSGroupsList;
    // private int a{ get; set; }
    //  private int b{ get; set; }

    private string? DegreeId { get; set; }
    private string? degree { get; set; }
    public string? EditPDSG { get; set; }
    public string? EditProvince { get; set; }
    public string? EditBU { get; set; }


    private void _DegreeOption(ChangeEventArgs e)
    {
        degree = e.Value as string;

    }
    private void LoadEducationalInfo()
    {
        this.PassingDegreeList = DALPassingDegree.GetPassingDegrees();
        this.PassingDSGroupsList = DALPassingDSGroups.GetPassingDSGroups();
    }
    protected override void OnInitialized()
    {
        LoadEducationalInfo();



    }



    private void SubmitForm()
    {
        if(degree=="1" || degree == "2")
        {
            _ModelInfo.Board_University = EditBU;
            _ModelInfo.PassingDSGroup = EditPDSG;
            //  _ModelInfo.DegreeName = "Matric";
            _ModelInfo.SID = "1";
            DALEducationalInfo.SaveStdMatricInfo(_ModelInfo);  
        }
        else
        {
             _ModelInfo.Board_University = EditBU;
            _ModelInfo.PassingDSGroup = EditPDSG;
            //  _ModelInfo.DegreeName = "Matric";
            _ModelInfo.SID = "1";
            DALEducationalInfo.SaveStdFscInfo(_ModelInfo);  
        }


    }
    private void _PGSGOption(ChangeEventArgs e)
    {
        EditPDSG = e.Value as string;
    }
   // private void _EditProvince(ChangeEventArgs e)
 //   {
 //       EditProvince = e.Value as string;
 //   }
    private void _EditBU(ChangeEventArgs e)
    {
        EditBU = e.Value as string;
    }

   // private int Perc{ get; set; }

    //private void CalPerc() => Perc = (a+ b);

}
