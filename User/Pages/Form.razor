@page "/form"
@using ClassLibraryDAL
@using ClassLibraryEntities


<div>
    <EditForm Model="_ModelInfo" OnSubmit="SubmitForm">
        <h2 class="text-center">Educational Information</h2>
        <div class="row mt-4 d-flex justify-content-center align-items-center">

            <div class="col-5">
                <label>Degree</label>
                <select class="form-select" aria-label="Default select example" @onchange="_DegreeOption">
                    <option selected>Select Degree</option>

                    @foreach (var reh in @PassingDegreeList)
                    {
                        <option value="@reh.PassingDegreesId">@reh.Title</option>
                    }
                </select>

            </div>


        </div>
        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Degree Groups</label>
                <select class="form-select" aria-label="Default select example" @onchange="_PGSGOption">
                    <option selected>Select Degree Group </option>

                    @foreach (var emp in @PassingDSGroupsList)
                    {
                        @if (degree == emp.PassingDegreeId)
                        {
                            <option value="@emp.PassingDSGroups">@emp.PassingDSGroups</option>
                        }

                    }
                </select>

            </div>

        </div>
        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Board/University</label>
                <Select @onchange="_EditBU" class="form-select ">
                    <option selected>Select Board</option>
                    <option value="Rwp">Rawalpindi</option>
                    <option value="Isl">Islamabad</option>

                </Select>

            </div>
        </div>


        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label> Obtained Marks </label>
                <InputText @bind-Value="_ModelInfo.ObtainedMarks" class="form-control" />

            </div>
        </div>
        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Total Marks</label>
                <InputText @bind-Value="_ModelInfo.TotalMarks" class="form-control" />

            </div>

        </div>

        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Percentage</label>
                <InputText @bind-Value="_ModelInfo.Percentage"   class="form-control"/>


            </div>
        </div>



        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Passing Year</label>
                <InputText @bind-Value="_ModelInfo.PassingYear" class="form-control" />

            </div>
        </div>

        <div class="row d-flex justify-content-center">


            <div class="col-5">
                <label>Institute</label>
                <InputText type="text" @bind-Value="_ModelInfo.Institute" class="form-control" />

            </div>
        </div>



        <div class="text-center ">
            <button type="submit" class="btn btn-primary " id="btn-register">Register</button>
            <button type="reset" class="btn btn-secondary">Cancel</button>
        </div>
    </EditForm>

</div>

<h2>SSC</h2>
<div class="container pt-4 table-responsive">
    <table class="table  table-bordered table-hover">
        <thead class="table-success">
            <tr scope="row">


                <th>Passing Degree Group</th>
                <th>Board/University</th>
                <th>Obtained Marks</th>
                <th>Total Marks</th>
                <th>Percentage</th>
                <th>Passing Year</th>
                <th>Institutes</th>
                <th>Action</th>

            </tr>
        </thead>
        <tbody>
            @foreach (var emp in @MatricList)
            {
                <tr scope="row" class="text-white">

                    <td>@emp.PassingDSGroup</td>
                    <td>@emp.Board_University</td>
                    <td>@emp.ObtainedMarks</td>
                    <td>@emp.TotalMarks</td>
                    <td>@emp.Percentage</td>
                    <td>@emp.PassingYear</td>
                    <td>@emp.Institute</td>

                    <button class="btn btn-danger" @onclick="(e => Delete(emp.SID))">DEL</button>
                </tr>

            }
        </tbody>
    </table>
</div>

<h2>HSSC</h2>
<div class="container pt-4 table-responsive">
    <table class="table  table-bordered table-hover">
        <thead class="table-success">
            <tr scope="row">


                <th>Passing Degree Group</th>
                <th>Board/University</th>
                <th>Obtained Marks</th>
                <th>Total Marks</th>
                <th>Percentage</th>
                <th>Passing Year</th>
                <th>Institutes</th>
                <th>Action</th>

            </tr>
        </thead>
        <tbody>
            @foreach (var emp in @FscList)
            {
                <tr scope="row" class="text-white">

                    <td>@emp.PassingDSGroup</td>
                    <td>@emp.Board_University</td>
                    <td>@emp.ObtainedMarks</td>
                    <td>@emp.TotalMarks</td>
                    <td>@emp.Percentage</td>
                    <td>@emp.PassingYear</td>
                    <td>@emp.Institute</td>

                     <button class="btn btn-danger" @onclick="(e => FDelete(emp.SID))">DEL</button>
                </tr>

            }
        </tbody>
    </table>
</div>

 

@code {

    private EntEducationalInfo? _ModelInfo { get; set; } = new EntEducationalInfo();
    private List<EntPassingDegree>? PassingDegreeList;
    private List<EntPassingDSGroups>? PassingDSGroupsList;
    private List<EntEducationalInfo>? MatricList;
    private List<EntEducationalInfo>? FscList;
    
    private string? DegreeId { get; set; }
    private string? degree { get; set; }
    public string? EditPDSG { get; set; }
    public string? EditProvince { get; set; }
    public string? EditBU { get; set; }


    private void _DegreeOption(ChangeEventArgs e)
    {
        degree = e.Value as string;

    }
    private void LoadEducationalInfo()
    {
        this.PassingDegreeList = DALPassingDegree.GetPassingDegrees();
        this.PassingDSGroupsList = DALPassingDSGroups.GetPassingDSGroups();
        this.MatricList = DALEducationalInfo.GetMatricInfo("1");
        this.FscList = DALEducationalInfo.GetFscInfo("1");
    }
    protected override void OnInitialized()
    {
        LoadEducationalInfo();
    }

    private void SubmitForm()
    {
      
        if (degree == "1" || degree == "2")
        {
         
            _ModelInfo.Board_University = EditBU;
            _ModelInfo.PassingDSGroup = EditPDSG;
            _ModelInfo.SID = "1";
            DALEducationalInfo.SaveStdMatricInfo(_ModelInfo);
            LoadEducationalInfo();
        }
        else
        {
            _ModelInfo.Board_University = EditBU;
            _ModelInfo.PassingDSGroup = EditPDSG;
            
            _ModelInfo.SID = "1";
            DALEducationalInfo.SaveStdFscInfo(_ModelInfo);
            LoadEducationalInfo();
        }


    }

    private void Delete(string id)
    {
        DALEducationalInfo.DeleteMatric(id);
        LoadEducationalInfo();
    }

      private void FDelete(string id)
    {
        DALEducationalInfo.DeleteFsc(id);
        LoadEducationalInfo();
    }

    private void _PGSGOption(ChangeEventArgs e)
    {
        EditPDSG = e.Value as string;
    }

    private void _EditBU(ChangeEventArgs e)
    {
        EditBU = e.Value as string;
    }

   
}
